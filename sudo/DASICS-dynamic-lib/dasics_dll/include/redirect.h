#ifndef _DASICS_DLL_INCLUDE_REDIRECT_H
#define _DASICS_DLL_INCLUDE_REDIRECT_H

#include <list.h>
#include <dasics_link.h>
#include <dasics_link_manager.h>

/* Designed to add a func which redirect to untrusted area */
typedef struct redirect
{
    char name[256];

    list_head list;
} redirect_t;

// The list
extern list_head redirect_table;
// The switch
extern int redirect_switch;



/* Add one item  */
int add_redirect_item(const char *func_name);


/* Delete one item from list */ 
int delete_redirect_item(const char *func_name);


/* Force relocation */
uint64_t force_redirect(umain_got_t * entry,const char * func_name, uint64_t target);



// Open/Close the switch
int open_redirect();
int close_redirect();


// Force redirect
int force_redirect_open();
int force_redirect_close();


#endif